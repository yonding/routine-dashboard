
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì¼ìƒ ë£¨í‹´ ëŒ€ì‹œë³´ë“œ</title>
<link rel="manifest" href="./manifest.webmanifest">
<meta name="theme-color" content="#0f1220">
<style>
  :root{
    --bg:#0f1220; --card:#171a2b; --muted:#8a8fa3; --text:#eef1ff; --accent:#6ea8fe; --good:#30d158; --warn:#ff9f0a; --bad:#ff453a;
  }
  *{box-sizing:border-box}
  body{
    margin:0; padding:16px; background:var(--bg); color:var(--text);
    font-family: system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Helvetica,Arial,sans-serif;
  }
  h1{font-size:22px; margin:0 0 8px}
  .row{display:grid; gap:12px}
  @media(min-width:900px){ .row{grid-template-columns:1.1fr .9fr} }
  .card{background:var(--card); border-radius:14px; padding:14px; box-shadow:0 10px 30px rgba(0,0,0,.25)}
  .muted{color:var(--muted)}
  .pill{display:inline-block; padding:4px 10px; border-radius:999px; font-size:12px; margin-right:6px; background:#222740; color:#cbd1ff}
  .btn{cursor:pointer; border:none; padding:10px 12px; border-radius:10px; background:var(--accent); color:#081028; font-weight:600}
  .btn.secondary{background:#2a2f4d; color:#cfe0ff}
  .btn.ghost{background:transparent; border:1px solid #394063; color:#cfe0ff}
  .btn:disabled{opacity:.6; cursor:not-allowed}
  .grid{display:grid; gap:8px}
  .timeline{position:relative; height:18px; background:#1d2240; border-radius:999px; overflow:hidden}
  .timeline .fill{position:absolute; left:0; top:0; bottom:0; background:linear-gradient(90deg,#6ea8fe,#9a7bff); width:0%}
  .block{display:flex; align-items:center; justify-content:space-between; gap:8px; padding:10px 12px; border:1px solid #2a2f4d; border-radius:12px}
  .block.active{border-color:#6ea8fe; background:rgba(110,168,254,.07)}
  .block .when{font-weight:600}
  .tag{font-size:12px; color:#b9c2ff}
  .flex{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
  .section-title{display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px}
  input[type="number"], input[type="text"], select{
    background:#1d2240; color:#eaf0ff; border:1px solid #303761; border-radius:10px; padding:8px 10px; width:100%;
  }
  .table{width:100%; border-collapse:collapse; font-size:14px}
  .table th,.table td{padding:8px; border-bottom:1px solid #2a2f4d; text-align:left}
  .tiny{font-size:12px}
  .success{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .kbd{background:#2a2f4d; color:#cfe0ff; padding:2px 6px; border-radius:6px; font-size:12px}
</style>
</head>
<body>
  <h1>ğŸ“† ì¼ìƒ ë£¨í‹´ ëŒ€ì‹œë³´ë“œ</h1>
  <div class="row">
    <section class="card">
      <div class="section-title">
        <div>
          <div class="muted tiny">í˜„ì¬ ì‹œê°„ëŒ€</div>
          <div id="nowLabel" style="font-size:18px; font-weight:700">-</div>
        </div>
        <div class="pill" id="nowTime">--:--</div>
      </div>
      <div class="timeline"><div class="fill" id="progressFill"></div></div>
      <div id="blocks" class="grid" style="margin-top:10px"></div>
      <div class="flex" style="margin-top:8px">
        <button class="btn" id="markDoneBtn">ì§€ê¸ˆ ë¸”ë¡ ì™„ë£Œ</button>
        <button class="btn secondary" id="startWorkRoutineBtn">ğŸš€ ì‘ì—… ì‹œì‘</button>
        <button class="btn ghost" id="exportCSV">ê¸°ë¡ CSV</button>
        <button class="btn ghost" id="downloadICS">ì£¼ê°„ .ics</button>
      </div>
      <div class="tiny muted" style="margin-top:6px">ì™„ë£Œ ì‹œê°ì´ ìë™ ê¸°ë¡ë©ë‹ˆë‹¤. ê° ë¸”ë¡ ì˜¤ë¥¸ìª½ì˜ ğŸ“… ë²„íŠ¼ìœ¼ë¡œ Google Calendarì— ë°”ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”.</div>
    </section>

    <section class="card">
      <div class="section-title">
        <div>
          <div class="muted tiny">ì˜¤ëŠ˜ì˜ ìš´ë™</div>
          <div id="todayWorkoutTitle" style="font-size:18px; font-weight:700">-</div>
        </div>
        <div class="pill" id="weekdayPill">-</div>
      </div>
      <div id="workoutList" class="grid"></div>
      <div class="flex" style="margin-top:10px">
        <button class="btn secondary" id="addSet">ì„¸íŠ¸ ì¶”ê°€</button>
        <button class="btn ghost" id="copyLast">ì§€ë‚œ ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <button class="btn ghost" id="startVoice">ğŸ¤ ìŒì„± ë¡œê·¸</button>
      </div>
      <table class="table" style="margin-top:10px">
        <thead><tr><th>ìš´ë™</th><th>kg</th><th>reps</th><th>ì„¸íŠ¸</th><th>ì‹œê°„</th></tr></thead>
        <tbody id="logBody"></tbody>
      </table>
      <div class="tiny muted">ìŒì„± ì˜ˆì‹œ: â€œë²¤ì¹˜ 80 6â€, â€œë¡œìš° 60 10â€. (ì§€ì› ë¸Œë¼ìš°ì €ì—ì„œë§Œ)</div>
    </section>
  </div>

  <section class="card" style="margin-top:12px">
    <div class="section-title">
      <div style="font-weight:700">ê¸°ë¡</div>
      <div class="pill" id="todaySummary">-</div>
    </div>
    <div id="history" class="grid"></div>
  </section>

<script>
// ===== Config =====
const dayBlocks = [
  {label:"ê¸°ìƒÂ·ë¬¼Â·ìŠ¤íŠ¸ë ˆì¹­", start:"07:00", end:"07:15", key:"wake"},
  {label:"ì•„ì¹¨ ìš´ë™ (ì›¨ì´íŠ¸+ìœ ì‚°ì†Œ)", start:"07:15", end:"08:45", key:"train"},
  {label:"ìƒ¤ì›ŒÂ·ì •ë¦¬", start:"08:45", end:"09:30", key:"prep"},
  {label:"ì²« ë‹¨ë°±ì§ˆ/WPI + ì˜ì–‘ì œ", start:"09:30", end:"09:40", key:"protein"},
  {label:"Deep Work 1", start:"09:40", end:"11:30", key:"deep1"},
  {label:"ì ì‹¬ (ì²« ì‹ì‚¬)", start:"11:30", end:"12:00", key:"lunch"},
  {label:"ì¶œê·¼Â·ì—…ë¬´", start:"12:30", end:"18:30", key:"work"},
  {label:"ì €ë…", start:"19:00", end:"19:30", key:"dinner"},
  {label:"Deep Work 2", start:"19:30", end:"21:00", key:"deep2"},
  {label:"ì‚°ì±…Â·ìŠ¤íŠ¸ë ˆì¹­", start:"21:00", end:"21:30", key:"walk"},
  {label:"ì·¨ì¹¨ ì¤€ë¹„(ë§ˆê·¸ë„¤ìŠ˜Â·í…Œì•„ë‹Œ)", start:"22:30", end:"23:00", key:"prebed"},
  {label:"ì·¨ì¹¨", start:"23:00", end:"23:59", key:"sleep"}
];

const templates = {
  1:{title:"ì›” â€” í‘¸ì‹œ(ê³ ì¤‘ëŸ‰)", items:["ë°± ìŠ¤ì¿¼íŠ¸ 4Ã—5 (RPE 8~9)","ë²¤ì¹˜í”„ë ˆìŠ¤ 4Ã—6","ì˜¤ë²„í—¤ë“œ í”„ë ˆìŠ¤ 3Ã—6~8","ì¸í´ë¼ì¸ ë¤ë²¨í”„ë ˆìŠ¤ 3Ã—8~10","ë”¥ìŠ¤ 2~3Ã—6~8","ì˜¤ë²„í—¤ë“œ íŠ¸ë¼ì´ì…‰ìŠ¤ ìµìŠ¤í…ì…˜ 2Ã—10"]},
  2:{title:"í™” â€” í’€(ê³ ì¤‘ëŸ‰)", items:["ë£¨ë§ˆë‹ˆì•ˆ ë°ë“œë¦¬í”„íŠ¸ 3~4Ã—5~6","í„±ê±¸ì´(ê°€ì¤‘) 4Ã—6~8","ë°”ë²¨/ë¤ë²¨ ë¡œìš° 3Ã—8~10","í˜ì´ìŠ¤í’€ 3Ã—12","í•´ë¨¸ì»¬ 3Ã—10"]},
  4:{title:"ëª© â€” í‘¸ì‹œ(ëŒ€ì‚¬ì„±)", items:["í”„ëŸ°íŠ¸/ê³ ë¸”ë¦¿ ìŠ¤ì¿¼íŠ¸ 3Ã—10 (RPE 7)","ì¸í´ë¼ì¸ ë²¤ì¹˜í”„ë ˆìŠ¤ 3~4Ã—8~10 (ë“œë¡­ì„¸íŠ¸)","ë¤ë²¨ ìˆ„ë”í”„ë ˆìŠ¤ 3Ã—10~12 (ë§ˆì´ì˜¤ë ˆí”„)","í‘¸ì‹œì—… 3Ã—12~15","ì¼€ì´ë¸” í”Œë¼ì´ 3Ã—15","ë¡œí”„ í‘¸ì‹œë‹¤ìš´ 2~3Ã—12~15"]},
  5:{title:"ê¸ˆ â€” í’€(ëŒ€ì‚¬ì„±)", items:["RDL(ì¤‘ëŸ‰â†“) 3Ã—10","í’€ë‹¤ìš´ 3Ã—12~15","ì¸ë²„í‹°ë“œ ë¡œìš° 3Ã—12","í˜ì´ìŠ¤í’€ 3Ã—15","ì¸í´ë¼ì¸ ë¤ë²¨ì»¬ 3Ã—12~15"]},
  6:{title:"í†  â€” íšŒë³µ ìœ ì‚°ì†Œ", items:["ë¹ ë¥¸ ê±·ê¸°/ìì „ê±°/í•˜ì´í‚¹ 30~40ë¶„","ìŠ¤íŠ¸ë ˆì¹­ 10ë¶„"]},
  0:{title:"ì¼ â€” íœ´ì‹", items:["ê°€ë²¼ìš´ ì‚°ì±… 20ë¶„","ìˆ˜ë©´ ë¦¬ë“¬ ìœ ì§€"]},
  3:{title:"ìˆ˜ â€” íšŒë³µ/ììœ ", items:["ìŠ¤íŠ¸ë ˆì¹­Â·ì‚°ì±… 20ë¶„","ì»¨ë””ì…˜ì— ë”°ë¼ íœ´ì‹"]}
};

// ===== Storage helpers =====
const store = {
  get k(){ return "routineLogs_v1"; },
  load(){ return JSON.parse(localStorage.getItem(this.k) || '{"blocks":{},"workout":[],"history":[]}'); },
  save(data){ localStorage.setItem(this.k, JSON.stringify(data)); }
};

function fmtHM(d){ return d.toTimeString().slice(0,5); }
function todayKey(){ const d=new Date(); return d.toISOString().slice(0,10); }
function parseTime(hm){
  const [h,m]=hm.split(":").map(Number);
  const d=new Date(); d.setHours(h, m, 0, 0); return d;
}
function pctOf(a,b,c){ return Math.max(0, Math.min(100, ((a-b)/(c-b))*100 )); }

// ===== Google Calendar helper =====
function openGCal(title, startDate, endDate, details=""){
  const pad=n=>String(n).padStart(2,'0');
  const fmt=(d)=>`${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}00`;
  const url = new URL("https://calendar.google.com/calendar/render");
  url.searchParams.set("action","TEMPLATE");
  url.searchParams.set("text", title);
  url.searchParams.set("dates", `${fmt(startDate)}/${fmt(endDate)}`);
  if(details) url.searchParams.set("details", details);
  url.searchParams.set("sf","true");
  url.searchParams.set("output","xml");
  window.open(url.toString(), "_blank");
}

// ===== Render blocks =====
function renderBlocks(){
  const container = document.getElementById("blocks");
  container.innerHTML = "";
  const now = new Date();
  document.getElementById("nowTime").textContent = fmtHM(now);

  const dayStart = parseTime(dayBlocks[0].start).getTime();
  const dayEnd   = parseTime(dayBlocks[dayBlocks.length-1].end).getTime();
  const p = pctOf(now.getTime(), dayStart, dayEnd);
  document.getElementById("progressFill").style.width = p + "%";

  const data = store.load();
  const tkey = todayKey();
  if(!data.blocks[tkey]) data.blocks[tkey] = {};

  let activeIndex=-1;
  dayBlocks.forEach((b, idx)=>{
    const s = parseTime(b.start), e = parseTime(b.end);
    const active = now>=s && now<=e;
    if(active) activeIndex = idx;
    const done = !!data.blocks[tkey][b.key];

    const div = document.createElement("div");
    div.className = "block"+(active?" active":"");
    div.innerHTML = `
      <div>
        <div class="when">${b.start}â€“${b.end} <span class="tag">${b.label}</span></div>
        <div class="tiny ${done?'success':'muted'}">${done?'ì™„ë£Œë¨':'ë¯¸ì™„ë£Œ'}</div>
      </div>
      <div class="flex">
        <button class="btn ghost" data-addgcal="${b.key}">ğŸ“…</button>
        <button class="btn ${done?'secondary':'ghost'}" data-key="${b.key}">${done?'ì™„ë£Œ ì·¨ì†Œ':'ì™„ë£Œ'}</button>
      </div>
    `;
    div.querySelector("[data-key]").onclick = ()=>{
      const data = store.load();
      const tkey = todayKey();
      if(!data.blocks[tkey]) data.blocks[tkey] = {};
      if(data.blocks[tkey][b.key]){
        delete data.blocks[tkey][b.key];
      } else {
        data.blocks[tkey][b.key] = new Date().toISOString();
      }
      store.save(data); renderBlocks(); renderHistory();
    };
    div.querySelector("[data-addgcal]").onclick = ()=>{
      const start = parseTime(b.start), end = parseTime(b.end);
      openGCal(b.label, start, end, "ë£¨í‹´ ëŒ€ì‹œë³´ë“œì—ì„œ ì¶”ê°€ë¨");
    };
    container.appendChild(div);
  });

  const nowLabel = activeIndex>=0 ? dayBlocks[activeIndex].label : "íœ´ì‹/ììœ  ì‹œê°„";
  document.getElementById("nowLabel").textContent = nowLabel;
}

// ===== Workout section =====
function renderWorkout(){
  const wd = new Date().getDay();
  const t = templates[wd];
  document.getElementById("weekdayPill").textContent = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "][wd];
  document.getElementById("todayWorkoutTitle").textContent = t ? t.title : "ì˜¤ëŠ˜: ììœ  / íšŒë³µ";
  const list = document.getElementById("workoutList");
  list.innerHTML = "";
  (t?.items||[]).forEach(txt=>{
    const div=document.createElement("div");
    div.className="block";
    div.innerHTML = `<div>${txt}</div><button class="btn ghost" data-ex="${txt}">ê¸°ë¡</button>`;
    div.querySelector("button").onclick = ()=> quickAdd(txt);
    list.appendChild(div);
  });
  const data = store.load();
  const tb = document.getElementById("logBody");
  tb.innerHTML="";
  (data.workout||[]).filter(x=>x.date===todayKey()).forEach(e=>{
    const tr=document.createElement("tr");
    tr.innerHTML = `<td>${e.name}</td><td>${e.kg||""}</td><td>${e.reps||""}</td><td>${e.sets||1}</td><td class="tiny muted">${e.time.slice(11,19)}</td>`;
    tb.appendChild(tr);
  });
}

function quickAdd(name){
  const kg = prompt(`${name}\në¬´ê²Œ(kg)? (ë¹ˆì¹¸ ê°€ëŠ¥)`);
  const reps = prompt(`${name}\në°˜ë³µ ìˆ˜(reps)? (ë¹ˆì¹¸ ê°€ëŠ¥)`);
  addLog({name, kg:kg?Number(kg):"", reps:reps?Number(reps):"", sets:1});
}

function addLog(entry){
  const data = store.load();
  data.workout = data.workout||[];
  data.workout.push({date:todayKey(), time:new Date().toISOString(), ...entry});
  store.save(data);
  renderWorkout(); renderHistory();
}

document.getElementById("addSet").onclick = ()=>{
  const name = prompt("ìš´ë™ ì´ë¦„? (ì˜ˆ: ë²¤ì¹˜í”„ë ˆìŠ¤)");
  if(!name) return;
  const kg = prompt("ë¬´ê²Œ(kg)?"); const reps = prompt("ë°˜ë³µ ìˆ˜?");
  addLog({name, kg:kg?Number(kg):"", reps:reps?Number(reps):"", sets:1});
};

document.getElementById("copyLast").onclick = ()=>{
  const data = store.load();
  const last = [...(data.workout||[])].reverse().find(x=>x.name);
  if(!last){ alert("ì§€ë‚œ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤."); return; }
  addLog({name:last.name, kg:last.kg, reps:last.reps, sets:last.sets||1});
};

// Voice logging
let recognizing=false, recog;
document.getElementById("startVoice").onclick = ()=>{
  if(!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)){
    alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."); return;
  }
  const SR = window.SpeechRecognition||window.webkitSpeechRecognition;
  recog = new SR(); recog.lang='ko-KR'; recog.interimResults=false; recog.maxAlternatives=1;
  recog.onresult=(e)=>{
    const s = e.results[0][0].transcript.trim();
    const parts = s.split(/\s+/);
    const name = parts[0]; const kg = Number(parts[1]); const reps = Number(parts[2]);
    if(name && !isNaN(kg) && !isNaN(reps)){ addLog({name, kg, reps, sets:1}); }
    else { alert("ì¸ì‹: "+s+"  (í˜•ì‹: 'ë²¤ì¹˜ 80 6')"); }
  };
  recog.onerror=(e)=>alert("ìŒì„± ì¸ì‹ ì˜¤ë¥˜: "+e.error);
  recog.onend=()=> recognizing=false;
  recognizing=true; recog.start();
};

// Auto-log via URL (for NFC/Shortcuts): ?add=ë²¤ì¹˜í”„ë ˆìŠ¤&kg=80&reps=6
(function(){
  const params = new URLSearchParams(location.search);
  if(params.has('add')){
    const name = params.get('add');
    const kg = Number(params.get('kg'));
    const reps = Number(params.get('reps'));
    addLog({name, kg: isNaN(kg)? "": kg, reps: isNaN(reps)? "": reps, sets:1});
    history.replaceState({}, "", location.pathname);
    alert(`ìë™ ê¸°ë¡ë¨: ${name} ${kg||''}kg x ${reps||''}`);
  }
})();

// Mark current block done
document.getElementById("markDoneBtn").onclick = ()=>{
  const now = new Date();
  const active = dayBlocks.find(b=> now>=parseTime(b.start) && now<=parseTime(b.end) );
  if(!active){ alert("í˜„ì¬ í™œì„± ë¸”ë¡ì´ ì—†ìŠµë‹ˆë‹¤."); return; }
  const data = store.load();
  const tkey = todayKey();
  data.blocks[tkey] = data.blocks[tkey]||{};
  data.blocks[tkey][active.key] = new Date().toISOString();
  store.save(data);
  renderBlocks(); renderHistory();
};

// (ì¶”ê°€ë¨) ì‘ì—… ì‹œì‘ ë²„íŠ¼ ìŠ¤í¬ë¦½íŠ¸
document.getElementById("startWorkRoutineBtn").onclick = ()=>{
  const videoUrl = "https://www.youtube.com/watch?v=gHLTEx\_kcfE";
  const musicUrl = "https://music.youtube.com/watch?v=RB-RcX5DS5A\&list=RDAMVMyKNxeF4KMsY";
  
  // ìƒˆ íƒ­ì—ì„œ ë‘ ê°œì˜ ë§í¬ë¥¼ ì—½ë‹ˆë‹¤.
  window.open(videoUrl, "_blank");
  window.open(musicUrl, "_blank");
};

// History
function renderHistory(){
  const data = store.load();
  const tkey = todayKey();
  const doneCount = Object.values(data.blocks[tkey]||{}).length;
  document.getElementById("todaySummary").textContent = `ì˜¤ëŠ˜ ì™„ë£Œ ${doneCount}/${dayBlocks.length}`;

  const container=document.getElementById("history");
  container.innerHTML="";
  const recent = (data.workout||[]).slice(-8).reverse();
  recent.forEach(e=>{
    const div=document.createElement("div");
    div.className="block";
    div.innerHTML = `<div><div>${e.name} ${e.kg||''}kg Ã— ${e.reps||''}</div>
      <div class="tiny muted">${e.date} ${e.time.slice(11,19)}</div></div>
      <button class="btn ghost">ì‚­ì œ</button>`;
    div.querySelector("button").onclick=()=>{
      const d = store.load();
      d.workout = d.workout.filter(x=> !(x.date===e.date && x.time===e.time) );
      store.save(d); renderWorkout(); renderHistory();
    }
    container.appendChild(div);
  });
}

// Export CSV
document.getElementById("exportCSV").onclick = ()=>{
  const data = store.load();
  let csv = "type,date,time,name,kg,reps,sets,key\n";
  (data.workout||[]).forEach(e=>{
    csv += `workout,${e.date},${e.time},${e.name||""},${e.kg||""},${e.reps||""},${e.sets||1},\n`;
  });
  Object.entries(data.blocks||{}).forEach(([d,keys])=>{
    Object.entries(keys).forEach(([k,t])=>{
      csv += `block,${d},${t},,,,"",${k}\n`;
    });
  });
  const blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url; a.download = "routine_logs.csv"; a.click();
  URL.revokeObjectURL(url);
};

// Export ICS (weekly recurring schedule)
document.getElementById("downloadICS").onclick = ()=>{
  const pad=n=>String(n).padStart(2,'0');
  const dt=(d)=>`${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}`;
  const t=(hm)=>hm.replace(":","")+"00";
  const today=new Date();
  const weekday=today.getDay();
  const monday = new Date(today); monday.setDate(today.getDate() - ((weekday+6)%7));
  let ics = "BEGIN:VCALENDAR\r\nVERSION:2.0\r\nPRODID:-//Routine Dashboard//KR//\r\n";
  dayBlocks.forEach(b=>{
    const s=parseTime(b.start), e=parseTime(b.end);
    const uid = `${b.key}-${Date.now()}@routine`;
    ics += "BEGIN:VEVENT\r\n";
    ics += `UID:${uid}\r\n`;
    ics += `SUMMARY:${b.label}\r\n`;
    ics += `DTSTART:${dt(today)}T${t(b.start)}\r\n`;
    ics += `DTEND:${dt(today)}T${t(b.end)}\r\n`;
    ics += "RRULE:FREQ=WEEKLY\r\n";
    ics += "END:VEVENT\r\n";
  });
  ics += "END:VCALENDAR\r\n";
  const blob = new Blob([ics], {type:"text/calendar;charset=utf-8;"});
  const url = URL.createObjectURL(blob);
  const a=document.createElement("a"); a.href=url; a.download="routine_weekly.ics"; a.click();
  URL.revokeObjectURL(url);
};

function renderAll(){ renderBlocks(); renderWorkout(); renderHistory(); }
renderAll(); setInterval(()=>renderBlocks(), 30000);

// Register SW
if('serviceWorker' in navigator){
  window.addEventListener('load', ()=>{
    navigator.serviceWorker.register('./sw.js').catch(()=>{});
  });
}
</script>
</body>
</html>
```
